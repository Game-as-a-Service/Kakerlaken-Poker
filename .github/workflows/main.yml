name: ðŸ‘· Main

on:
  push:
    branches: [main]

jobs:
  check_main_branch:
    runs-on: ubuntu-latest
    outputs:
      is_main: ${{ steps.main_branch_check.outputs.is_main }}
    steps:
      - name: Check if it comes from the main branch
        id: main_branch_check
        run: echo "is_main=${{ github.ref == 'refs/heads/main' }}" >> $GITHUB_OUTPUT

  push_main:
    needs: check_main_branch
    if: needs.check_main_branch.outputs.is_main == 'true'
    uses: ./.github/workflows/pushMain.yml
    secrets: inherit

  merge_notify:
    needs: check_main_branch
    if: needs.check_main_branch.outputs.is_main == 'false' && always()
    uses: ./.github/workflows/mergeNotify.yml
    secrets: inherit
